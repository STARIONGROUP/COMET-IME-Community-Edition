<Project Sdk="Microsoft.NET.Sdk">
  <PropertyGroup>
    <ProjectGuid>{03C264A0-398B-4C78-83BA-EDEA6BA7F679}</ProjectGuid>
    <MinIMEVersion>10.0.3</MinIMEVersion>
    <RootNamespace>CDP4ServicesDalPlugin</RootNamespace>
    <AssemblyName>CDP4ServicesDalPlugin</AssemblyName>
    <TargetFramework>net48</TargetFramework>
    <SolutionDir Condition="$(SolutionDir) == '' Or $(SolutionDir) == '*Undefined*'">..\</SolutionDir>
    <AssemblyTitle>CDP4ServicesDal</AssemblyTitle>
    <Company>Starion Group S.A</Company>
    <Product>CDP4ServicesDal</Product>
    <Description>CDP4-COMET Services DAL to be used exclusively with CDP4-COMET Services</Description>
    <Copyright>Copyright © Starion Group S.A</Copyright>
    <AssemblyVersion>11.0.0.4</AssemblyVersion>
    <FileVersion>11.0.0.4</FileVersion>
    <UseWPF>true</UseWPF>
    <UseWindowsForms>true</UseWindowsForms>
	<CopyLocalLockFileAssemblies>true</CopyLocalLockFileAssemblies>
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Debug|AnyCPU' ">
    <DebugType>full</DebugType>
    <OutputPath>..\CDP4IME\bin\$(Configuration)\$(TargetFramework)\plugins\CDP4ServicesDal\</OutputPath>
    <AppendTargetFrameworkToOutputPath>false</AppendTargetFrameworkToOutputPath>
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Release|AnyCPU' ">
    <DebugType>pdbonly</DebugType>
    <OutputPath>bin\$(Configuration)\</OutputPath>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)' == 'Debug|x64'">
    <OutputPath>..\CDP4IME\bin\$(Configuration)\$(TargetFramework)\plugins\CDP4ServicesDal\</OutputPath>
    <AppendTargetFrameworkToOutputPath>false</AppendTargetFrameworkToOutputPath>
    <DebugType>full</DebugType>
    <CodeAnalysisRuleSet>MinimumRecommendedRules.ruleset</CodeAnalysisRuleSet>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)' == 'Release|x64'">
    <OutputPath>bin\$(Configuration)\</OutputPath>
    <DebugType>pdbonly</DebugType>
    <CodeAnalysisRuleSet>MinimumRecommendedRules.ruleset</CodeAnalysisRuleSet>
  </PropertyGroup>
  <Import Project="..\Sdk.Plugin.target" />
  <ItemGroup>
    <PackageReference Include="CDP4Common-CE" Version="28.0.0-rc31">
      <ExcludeAssets>runtime</ExcludeAssets>
    </PackageReference>
    <PackageReference Include="CDP4Dal-CE" Version="28.0.0-rc31">
      <ExcludeAssets>runtime</ExcludeAssets>
    </PackageReference>
    <PackageReference Include="CDP4JsonSerializer-CE" Version="28.0.0-rc31">
      <ExcludeAssets>runtime</ExcludeAssets>
    </PackageReference>
    <PackageReference Include="CDP4ServicesDal-CE" Version="28.0.0-rc31" />

    <!--This extra reference to Microsoft.Bcl.AsyncInterfaces is necessary, as version 8.0.0 is references by MessagePack 3.1.1
    Transitive references/versions are sometimes preferred over AssemblyRedirects by default. Adding this reference to a specific version of Microsoft.Bcl.AsyncInterfaces
    here results in the correct version being used by the CDPServices plugin at runtime.
    Please notice that this "problem" with importancy of assembly references is different in COMET-IME.exe and the Excel addin.
    Problems in the Excel Addin might not be present in the COMET-IME.exe (and maybe even vice versa).
    -->
    <PackageReference Include="Microsoft.Bcl.AsyncInterfaces" Version="9.0.1" >
      <ExcludeAssets>runtime</ExcludeAssets>
    </PackageReference>
    
    <PackageReference Include="CommonServiceLocator" Version="2.0.7">
      <ExcludeAssets>runtime</ExcludeAssets>
    </PackageReference>
    <PackageReference Include="Newtonsoft.Json" Version="13.0.3">
      <ExcludeAssets>runtime</ExcludeAssets>
    </PackageReference>
    <PackageReference Include="NLog" Version="5.3.4">
      <ExcludeAssets>runtime</ExcludeAssets>
    </PackageReference>
    <PackageReference Include="NLog.Extensions.Logging" Version="5.3.15">
	  <ExcludeAssets>runtime</ExcludeAssets>
    </PackageReference>
    <PackageReference Include="System.Reactive" Version="6.0.1">
	  <ExcludeAssets>runtime</ExcludeAssets>
	</PackageReference>
    <PackageReference Include="System.Xml.XmlSerializer" Version="4.3.0">
      <ExcludeAssets>runtime</ExcludeAssets>
    </PackageReference>
    <PackageReference Include="System.Threading.Tasks.Extensions" Version="4.5.4">
	    <ExcludeAssets>runtime</ExcludeAssets>
    </PackageReference>
  </ItemGroup>
  <ItemGroup>
    <Reference Include="System.ComponentModel.Composition">
      <Private>false</Private>
    </Reference>
    <Reference Include="System.Configuration">
      <Private>false</Private>
    </Reference>
    <Reference Include="System.IO.Compression">
      <Private>false</Private>
    </Reference>
    <Reference Include="System.Net">
      <Private>false</Private>
    </Reference>
    <Reference Include="System.Net.Http">
      <Private>false</Private>
    </Reference>
    <Reference Include="System.ServiceModel">
      <Private>false</Private>
    </Reference>
    <Reference Include="System.Transactions">
      <Private>false</Private>
    </Reference>
    <Reference Include="System.Data.DataSetExtensions">
      <Private>false</Private>
    </Reference>
    <Reference Include="Microsoft.CSharp">
      <Private>false</Private>
    </Reference>
  </ItemGroup>
  <ItemGroup>
    <Reference Update="System">
      <Private>false</Private>
    </Reference>
  </ItemGroup>
  <ItemGroup>
    <Reference Update="System.Core">
      <Private>false</Private>
    </Reference>
  </ItemGroup>
  <ItemGroup>
    <Reference Update="System.Data">
      <Private>false</Private>
    </Reference>
  </ItemGroup>
  <ItemGroup>
    <Reference Update="System.Drawing">
      <Private>false</Private>
    </Reference>
  </ItemGroup>
  <ItemGroup>
    <Reference Update="System.IO.Compression.FileSystem">
      <Private>false</Private>
    </Reference>
  </ItemGroup>
  <ItemGroup>
    <Reference Update="System.Numerics">
      <Private>false</Private>
    </Reference>
  </ItemGroup>
  <ItemGroup>
    <Reference Update="System.Runtime.Serialization">
      <Private>false</Private>
    </Reference>
  </ItemGroup>
  <ItemGroup>
    <Reference Update="System.Xml">
      <Private>false</Private>
    </Reference>
  </ItemGroup>
  <ItemGroup>
    <Reference Update="System.Xml.Linq">
      <Private>false</Private>
    </Reference>
  </ItemGroup>
</Project>